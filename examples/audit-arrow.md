# Crossing Audit Report: arrow

**Project:** arrow
**Scanned:** 2026-02-24
**Tool:** Crossing Semantic Scanner v0.9

---

## Executive Summary

arrow has **3 semantic boundary crossings**, including **1 high-risk** findings. For a 10-file codebase with 52 raise sites and 12 handlers, this gives a crossing density of 0.30 per file.

**Risk Level:** Medium-High.

---

## Scan Summary

| Metric | Value |
|--------|-------|
| Files scanned | 10 |
| Raise sites | 52 |
| Exception handlers | 12 |
| Total crossings | 3 |
| High risk | 1 |
| Elevated risk | 0 |
| Medium risk | 0 |
| Low risk | 2 |
| Mean collapse ratio | 25% |

---

## Findings

### HIGH RISK: `ValueError` — 42 raise sites, 2 handlers

**Files:** `arrow.py`, `locales.py`, `parser.py`, `util.py`
**Impact:** `ValueError` is raised at 42 sites across 4 files (arrow.py, locales.py, parser.py, util.py), in 27 different functions. 2 handlers (1 re-raise, 1 return).

**Raise sites:**
- `arrow.py:258` raise `ValueError` in `Arrow.fromtimestamp` — if not util.is_timestamp(timestamp) → raise in fromtimestamp
- `arrow.py:284` raise `ValueError` in `Arrow.utcfromtimestamp` — if not util.is_timestamp(timestamp) → raise in utcfromtimestamp
- `arrow.py:560` raise `ValueError` in `Arrow.span` — if not 1 <= week_start <= 7 → raise in span (`"week_start argument must be between 1 and 7.`)
- `arrow.py:777` raise `ValueError` in `Arrow.interval` — if interval < 1 → raise in interval (`"interval has to be a positive integer`)
- `arrow.py:977` raise `ValueError` in `Arrow.replace` — elif key in ["week", "quarter"] → raise in replace
- `arrow.py:979` raise `ValueError` in `Arrow.replace` — elif key not in ["tzinfo", "fold"] → raise in replace
- `arrow.py:1039` raise `ValueError` in `Arrow.shift` — if key in self._ATTRS_PLURAL or key in additional_attrs → raise in shift
- `arrow.py:1288` raise `ValueError` in `Arrow.humanize` — elif granularity == "year" → raise in humanize (`"Invalid level of granularity. Please select between 'second'...`)
- ... and 34 more

**Handlers:**
- `parser.py:756` — except `ValueError` in `DateTimeParser._build_datetime` (re-raises)
- `util.py:54` — except `ValueError` in `is_timestamp` (returns)

**Information theory:** 4.8 bits entropy, 2.4 bits lost, 50% collapse

**Recommendation:** `ValueError` is a broad built-in type carrying 42 different meanings here. Consider defining project-specific exception subclasses, or narrowing handler try-blocks to minimize the catch surface.

---

## Benchmark Context

| Project | Files | Crossings | Elevated+ | Density |
|---------|-------|-----------|-----------|---------|
| **arrow** | **10** | **3** | **1** | **0.30** |
| click | 17 | 11 | 4 | 0.65 |
| requests | 18 | 5 | 2 | 0.28 |
| hypothesis | 103 | 29 | 7 | 0.28 |
| invoke | 47 | 12 | 3 | 0.26 |
| flask | 24 | 6 | 2 | 0.25 |
| tqdm | 31 | 7 | 3 | 0.23 |
| scrapy | 113 | 23 | 8 | 0.20 |
| uvicorn | 40 | 7 | 3 | 0.18 |
| colorama | 7 | 1 | 0 | 0.14 |
| httpx | 23 | 3 | 0 | 0.13 |
| pytest | 71 | 9 | 9 | 0.13 |
| celery | 161 | 12 | 3 | 0.07 |
| rich | 100 | 5 | 1 | 0.05 |
| fastapi | 47 | 0 | 0 | 0.00 |

arrow's crossing density (0.30) is in line with the benchmark average (0.20).

---

## Methodology

Crossing performs static AST analysis on Python source files. It maps every `raise` statement to every `except` handler that could catch it, then identifies **semantic boundary crossings** — places where the same exception type is raised with different meanings in different contexts. No code is executed; no network calls are made; no dependencies are required.

Risk levels:
- **Low:** Single raise site or uniform semantics
- **Medium:** Multiple raise sites in different functions — handler may not distinguish
- **Elevated:** Many divergent raise sites — high chance of incorrect handling
- **High:** Handler collapse — many raise sites, very few handlers, ambiguous behavior

---

*Report generated by [Crossing](https://fridayops.xyz/crossing/) v0.9*  
*Scan performed 2026-02-24*
